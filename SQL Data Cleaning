Select *
From layoffs
;



-- Removing Duplicates


Create Table layoffs_cleaning
Like layoffs
;

Select *
From layoffs_cleaning
;

Insert layoffs_cleaning
Select *
From layoffs
;

Select *,
Row_number()
	Over(partition by
			company,
            location,
            industry,
            total_laid_off,
            percentage_laid_off,
            `date`,
            stage,
            country,
            funds_raised_millions
		)
	as row_num
From layoffs_cleaning
;

With duplicate_cte As
(
Select *,
Row_number()
	Over(partition by
			company,
            location,
            industry,
            total_laid_off,
            percentage_laid_off,
            `date`,
            stage,
            country,
            funds_raised_millions
		)
	as row_num
From layoffs_cleaning
)

Select *
From duplicate_cte
Where row_num > 1
;

Select *
From layoffs_cleaning
Where company = 'Wildlife Studios'
;

CREATE TABLE `layoffs_cleaning_2` (
  `company` text,
  `location` text,
  `industry` text,
  `total_laid_off` int DEFAULT NULL,
  `percentage_laid_off` text,
  `date` text,
  `stage` text,
  `country` text,
  `funds_raised_millions` int DEFAULT NULL,
  `row_num` Int
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

Select *
From layoffs_cleaning_2
;

Insert Into layoffs_cleaning_2
Select *,
Row_number()
	Over(partition by 
			company,
            location,
            industry,
            total_laid_off,
            percentage_laid_off,
            `date`,
            stage,
            country,
            funds_raised_millions
		)
	as row_num
From layoffs_cleaning
;

Delete
From layoffs_cleaning_2
Where row_num > 1
;

Select *
From layoffs_cleaning_2
Where row_num > 1
;



-- Standardizing Data


Select company, trim(company)
From layoffs_cleaning_2
;

Update layoffs_cleaning_2
Set company = Trim(company)
;

Select Distinct industry
From layoffs_cleaning_2
order by industry
;

Select *
From layoffs_cleaning_2
Where industry Like 'Crypto%'
;

Update layoffs_cleaning_2
Set industry = 'Crypto'
Where industry Like 'Crypto%'
;

Select Distinct location
From layoffs_cleaning_2
Order by location
;

Update layoffs_cleaning_2
Set location = 'Dusseldorf'
Where location = 'DÃ¼sseldorf'
;

Update layoffs_cleaning_2
Set location = 'Florianópolis'
Where location = 'FlorianÃ³polis'
;

Update layoffs_cleaning_2
Set location = 'Malmo'
Where location = 'MalmÃ¶'
;

Select distinct country
From layoffs_cleaning_2
Order by country
;

Update layoffs_cleaning_2
Set country = 'United States'
Where country like 'United States%'
;

Select `date`,
str_to_date(`date`, '%m/%d/%Y')
From layoffs_cleaning_2
;

Update layoffs_cleaning_2
Set `date` = str_to_date(`date`, '%m/%d/%Y')
;

Select `date`
From layoffs_cleaning_2
;

Alter Table layoffs_cleaning_2
Modify column `date` date
;



-- Look at Null and Blank Values


Select *
From layoffs_cleaning_2
Where industry is null
;

Select *
From layoffs_cleaning_2
Where industry = ''
;

Select *
From layoffs_cleaning_2
Where company = 'Bally''s Interactive'
; 

Update layoffs_cleaning_2
set industry = 'Consumer'
Where company = 'Juul'
and industry = ''
;

Select *
From layoffs_cleaning_2
Where total_laid_off is null
	And
		percentage_laid_off is null
;

Delete
From layoffs_cleaning_2
Where total_laid_off is null
	And
		percentage_laid_off is null
;



-- Remove Any Columns


Alter Table layoffs_cleaning_2
Drop Column row_num
;

Select *
From layoffs_cleaning_2
;

